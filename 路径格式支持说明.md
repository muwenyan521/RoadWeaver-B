# 路径格式支持说明

## ✅ 已修复

现在完全支持包含斜杠 `/` 的结构 ID，例如 `mvs:houses/azelea_house`！

## 🔧 修复内容

### 问题
之前的正则表达式 `^[^a-z0-9_.:-]+` 会过滤掉斜杠 `/`，导致路径格式的结构 ID 无法正确解析。

### 解决方案
更新正则表达式为 `^[^a-z0-9_.:/\-]+`，保留斜杠字符。

## 📝 支持的格式

### 1. 标准格式
```
modid:structure_name
```
示例：`minecraft:village_plains`

### 2. 路径格式（新增支持）
```
modid:category/structure_name
```
示例：`mvs:houses/azelea_house`

### 3. 多级路径
```
modid:category/subcategory/structure_name
```
示例：`modid:buildings/residential/house_small`

## 🎯 实际应用

### MVS (More Vanilla Structures) 模组

MVS 模组使用路径格式组织结构：

#### 精确匹配
```json
{
  "structuresToLocate": [
    "mvs:houses/azelea_house",
    "mvs:houses/oak_house",
    "mvs:shops/blacksmith"
  ]
}
```

#### 通配符匹配（推荐）
```json
{
  "structuresToLocate": [
    "mvs:houses/*",    // 匹配所有房屋
    "mvs:shops/*",     // 匹配所有商店
    "mvs:*"            // 匹配所有 MVS 结构
  ]
}
```

### 其他模组示例

#### 地牢模组
```json
{
  "structuresToLocate": [
    "dungeons:underground/*",
    "dungeons:surface/*",
    "dungeons:nether/*"
  ]
}
```

#### 建筑模组
```json
{
  "structuresToLocate": [
    "buildings:residential/*",
    "buildings:commercial/*",
    "buildings:industrial/*"
  ]
}
```

## 📊 路径匹配规则

### 前缀匹配
通配符 `*` 会匹配路径中的所有内容：

| 配置 | 匹配示例 |
|------|----------|
| `mvs:*` | `mvs:houses/oak`, `mvs:shops/blacksmith`, `mvs:anything` |
| `mvs:houses/*` | `mvs:houses/oak`, `mvs:houses/birch`, `mvs:houses/azelea` |
| `mvs:houses/oak*` | `mvs:houses/oak_small`, `mvs:houses/oak_large` |

### 多级路径匹配
```json
{
  "structuresToLocate": [
    "modid:buildings/residential/*",      // 匹配所有住宅建筑
    "modid:buildings/commercial/shops/*", // 匹配所有商店
    "modid:*"                             // 匹配所有结构
  ]
}
```

## ⚙️ 技术细节

### 允许的字符
结构 ID 中允许以下字符：
- 小写字母：`a-z`
- 数字：`0-9`
- 下划线：`_`
- 点：`.`
- 冒号：`:`（命名空间分隔符）
- 斜杠：`/`（路径分隔符）
- 连字符：`-`

### 正则表达式
```java
String cleaned = token.replaceAll("^[^a-z0-9_.:/\\-]+", "");
```

这会移除前置的非法字符，但保留所有合法字符。

## 🔍 调试技巧

### 1. 查看日志
启动游戏后查看日志，确认匹配结果：
```
[INFO] RoadWeaver: 通配符 'mvs:houses/*' 匹配到 12 个结构
```

### 2. 测试单个结构
先测试精确匹配：
```json
{
  "structuresToLocate": [
    "mvs:houses/azelea_house"
  ]
}
```

如果成功，再使用通配符：
```json
{
  "structuresToLocate": [
    "mvs:houses/*"
  ]
}
```

### 3. 查看所有结构
使用 `/locate structure` 命令查看可用的结构 ID：
```
/locate structure mvs:houses/azelea_house
```

## 📖 常见模组格式

### MVS (More Vanilla Structures)
```
mvs:houses/azelea_house
mvs:houses/oak_house
mvs:shops/blacksmith
mvs:shops/library
```

### When Dungeons Arise
```
dungeons_arise:shiraz_palace
dungeons_arise:monastery
dungeons_arise:aviary
```

### YUNG's Better系列
```
yungsbettermineshafts:mineshaft_desert
yungsbetterstrongholds:stronghold
yungsbetterdungeons:dungeon_spider
```

## 🎯 最佳实践

### 1. 优先使用通配符
```json
{
  "structuresToLocate": [
    "mvs:houses/*"    // 推荐
  ]
}
```

而不是：
```json
{
  "structuresToLocate": [
    "mvs:houses/azelea_house",
    "mvs:houses/oak_house",
    "mvs:houses/birch_house",
    // ... 太多了
  ]
}
```

### 2. 按类别组织
```json
{
  "structuresToLocate": [
    "#minecraft:village",      // 原版村庄
    "mvs:houses/*",            // MVS 房屋
    "mvs:shops/*",             // MVS 商店
    "dungeons_arise:*",        // 地牢崛起所有
    "yungsbetter*:*"           // YUNG's 系列所有
  ]
}
```

### 3. 从宽到窄
如果匹配过多，逐步缩小范围：
```
mvs:*                  // 太宽泛，可能匹配几百个
↓
mvs:houses/*           // 只要房屋类
↓
mvs:houses/oak*        // 只要橡木系列
```

## ⚠️ 注意事项

### 1. 大小写敏感
Minecraft 资源位置是**大小写敏感**的：
- ✅ `mvs:houses/azelea_house`
- ❌ `MVS:Houses/Azelea_House`

### 2. 命名空间必须小写
```
✅ mvs:houses/oak
❌ MVS:houses/oak
❌ Mvs:houses/oak
```

### 3. 路径分隔符
只能使用正斜杠 `/`，不能使用反斜杠 `\`：
- ✅ `mvs:houses/oak`
- ❌ `mvs:houses\oak`

## 🚀 总结

现在你可以：
- ✅ 使用路径格式的结构 ID（如 `mvs:houses/azelea_house`）
- ✅ 使用通配符匹配路径（如 `mvs:houses/*`）
- ✅ 支持多级路径（如 `modid:category/subcategory/name`）
- ✅ 混合使用标签、精确ID和通配符

**示例配置**：
```json
{
  "structuresToLocate": [
    "#minecraft:village",
    "mvs:houses/*",
    "mvs:shops/*",
    "dungeons_arise:*"
  ]
}
```

轻松管理所有模组结构！🎉
