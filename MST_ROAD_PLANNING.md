# æœ€å°ç”Ÿæˆæ ‘é“è·¯è§„åˆ’ç®—æ³•

## ğŸ¯ é—®é¢˜èƒŒæ™¯

### åŸæœ‰ç®—æ³•çš„é—®é¢˜

**æœ€è¿‘é‚»ç®—æ³•**ï¼šæ¯æ¬¡åªè¿æ¥æœ€æ–°ç»“æ„åˆ°æœ€è¿‘çš„ä¸€ä¸ªç»“æ„

```
é—®é¢˜ç¤ºä¾‹ï¼š
ç»“æ„ A, B, C, D, E

åŸç®—æ³•ï¼š
1. å‘ç° A
2. å‘ç° B â†’ è¿æ¥ B-Aï¼ˆæœ€è¿‘ï¼‰
3. å‘ç° C â†’ è¿æ¥ C-Aï¼ˆæœ€è¿‘ï¼‰
4. å‘ç° D â†’ è¿æ¥ D-Bï¼ˆæœ€è¿‘ï¼‰
5. å‘ç° E â†’ è¿æ¥ E-Cï¼ˆæœ€è¿‘ï¼‰

ç»“æœï¼š
- åªæœ‰ 4 æ¡è¿æ¥
- ä¸æ˜¯æœ€ä¼˜è·¯å¾„
- å¯èƒ½æœ‰äº›ç»“æ„è¿æ¥ä¸ä¸Š
```

### ç†æƒ³ç®—æ³•ï¼šæœ€å°ç”Ÿæˆæ ‘ï¼ˆMSTï¼‰

**Kruskal ç®—æ³•**ï¼šç¡®ä¿æ‰€æœ‰ç»“æ„äº’ç›¸è¿é€šä¸”æ€»è·¯å¾„æœ€çŸ­

```
MST ç®—æ³•ï¼š
1. è®¡ç®—æ‰€æœ‰ç»“æ„å¯¹ä¹‹é—´çš„è·ç¦»
2. æŒ‰è·ç¦»ä»å°åˆ°å¤§æ’åº
3. é€ä¸ªæ·»åŠ æœ€çŸ­çš„è¾¹ï¼Œé¿å…å½¢æˆç¯è·¯
4. ç›´åˆ°æ‰€æœ‰ç»“æ„è¿é€š

ç»“æœï¼š
- æ°å¥½ n-1 æ¡è¿æ¥ï¼ˆn ä¸ªç»“æ„ï¼‰
- æ‰€æœ‰ç»“æ„éƒ½èƒ½äº’ç›¸åˆ°è¾¾
- æ€»è·¯å¾„é•¿åº¦æœ€çŸ­
- ä¸ä¼šæœ‰ç¯è·¯ï¼ˆæµªè´¹ï¼‰
```

## ğŸ’¡ Kruskal ç®—æ³•å®ç°

### æ ¸å¿ƒæ­¥éª¤

```java
1. ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„è¾¹ï¼ˆç»“æ„å¯¹ï¼‰
   for i in 0..n:
       for j in i+1..n:
           edges.add(Edge(structure[i], structure[j], distance))

2. æŒ‰è·ç¦»æ’åºï¼ˆä»å°åˆ°å¤§ï¼‰
   edges.sort(by distance)

3. ä½¿ç”¨å¹¶æŸ¥é›†ï¼ˆUnion-Findï¼‰é¿å…ç¯è·¯
   UnionFind uf = new UnionFind(structures)

4. é€ä¸ªæ·»åŠ æœ€çŸ­çš„è¾¹
   for edge in edges:
       if uf.union(edge.from, edge.to):  // ä¸ä¼šå½¢æˆç¯è·¯
           result.add(edge)
           if result.size() == n-1:  // å·²è¿é€šæ‰€æœ‰èŠ‚ç‚¹
               break
```

### å¹¶æŸ¥é›†ï¼ˆUnion-Findï¼‰

ç”¨äºé«˜æ•ˆæ£€æµ‹å’Œåˆå¹¶é›†åˆï¼š

```java
class UnionFind {
    Map<BlockPos, BlockPos> parent;
    
    // æŸ¥æ‰¾æ ¹èŠ‚ç‚¹ï¼ˆå¸¦è·¯å¾„å‹ç¼©ï¼‰
    BlockPos find(BlockPos node) {
        if (parent.get(node) != node) {
            parent.put(node, find(parent.get(node)));  // è·¯å¾„å‹ç¼©
        }
        return parent.get(node);
    }
    
    // åˆå¹¶ä¸¤ä¸ªé›†åˆ
    boolean union(BlockPos a, BlockPos b) {
        BlockPos rootA = find(a);
        BlockPos rootB = find(b);
        
        if (rootA == rootB) {
            return false;  // å·²åœ¨åŒä¸€é›†åˆï¼Œä¼šå½¢æˆç¯è·¯
        }
        
        parent.put(rootA, rootB);  // åˆå¹¶
        return true;
    }
}
```

## ğŸ“Š ç®—æ³•å¯¹æ¯”

### ç¤ºä¾‹ï¼š5 ä¸ªç»“æ„

```
ç»“æ„ä½ç½®ï¼š
A (0, 0)
B (100, 0)
C (200, 0)
D (50, 100)
E (150, 100)

æ‰€æœ‰å¯èƒ½çš„è¾¹ï¼ˆ10 æ¡ï¼‰ï¼š
A-B: 100
A-C: 200
A-D: 112
A-E: 180
B-C: 100
B-D: 112
B-E: 112
C-D: 180
C-E: 112
D-E: 100
```

### åŸç®—æ³•ï¼ˆæœ€è¿‘é‚»ï¼‰

```
å‡è®¾å‘ç°é¡ºåºï¼šA â†’ B â†’ C â†’ D â†’ E

è¿æ¥ï¼š
1. B-A (100)  â† B çš„æœ€è¿‘é‚»æ˜¯ A
2. C-B (100)  â† C çš„æœ€è¿‘é‚»æ˜¯ B
3. D-A (112)  â† D çš„æœ€è¿‘é‚»æ˜¯ A
4. E-B (112)  â† E çš„æœ€è¿‘é‚»æ˜¯ B

æ€»é•¿åº¦ï¼š424
è¿æ¥æ•°ï¼š4 æ¡

é—®é¢˜ï¼š
- ä¾èµ–å‘ç°é¡ºåº
- ä¸æ˜¯æœ€ä¼˜è§£
- å¯èƒ½é—æ¼æ›´å¥½çš„è¿æ¥
```

### MST ç®—æ³•ï¼ˆKruskalï¼‰

```
æ’åºåçš„è¾¹ï¼š
1. A-B: 100
2. B-C: 100
3. D-E: 100
4. A-D: 112
5. B-D: 112
6. B-E: 112
7. C-E: 112
8. A-E: 180
9. C-D: 180
10. A-C: 200

Kruskal è¿‡ç¨‹ï¼š
1. æ·»åŠ  A-B (100) âœ…
2. æ·»åŠ  B-C (100) âœ…
3. æ·»åŠ  D-E (100) âœ…
4. æ·»åŠ  A-D (112) âœ…  â† è¿é€š {A,B,C} å’Œ {D,E}
5. è·³è¿‡ B-D (112) âŒ  â† ä¼šå½¢æˆç¯è·¯
6. è·³è¿‡ B-E (112) âŒ  â† ä¼šå½¢æˆç¯è·¯
... å·²æœ‰ 4 æ¡è¾¹ï¼Œ5 ä¸ªèŠ‚ç‚¹å·²è¿é€š

æœ€ç»ˆè¿æ¥ï¼š
A-B (100)
B-C (100)
D-E (100)
A-D (112)

æ€»é•¿åº¦ï¼š412 âœ… æ¯”åŸç®—æ³•å°‘ 12
è¿æ¥æ•°ï¼š4 æ¡ï¼ˆæ°å¥½ n-1ï¼‰

ä¼˜åŠ¿ï¼š
- ä¸ä¾èµ–å‘ç°é¡ºåº
- ä¿è¯æœ€ä¼˜è§£
- æ‰€æœ‰ç»“æ„éƒ½èƒ½äº’ç›¸åˆ°è¾¾
```

## ğŸ® å®é™…æ•ˆæœ

### åœ°å›¾ç¤ºä¾‹

```
åŸç®—æ³•ï¼š
  A --- B --- C
  |           
  D     E

é—®é¢˜ï¼šD å’Œ E æ²¡æœ‰è¿æ¥ï¼

MST ç®—æ³•ï¼š
  A --- B --- C
  |           |
  D --------- E

æ‰€æœ‰ç»“æ„éƒ½èƒ½äº’ç›¸åˆ°è¾¾ï¼
```

### æ—¥å¿—ç¤ºä¾‹

```
[Server thread/INFO] RoadWeaver: å¼€å§‹ä½¿ç”¨æœ€å°ç”Ÿæˆæ ‘ç®—æ³•è§„åˆ’é“è·¯ç½‘ç»œ (10 ä¸ªç»“æ„)
[Server thread/INFO] RoadWeaver: åˆ›å»ºé“è·¯è¿æ¥ (100, 64, 200) <-> (300, 64, 400) (è·ç¦»: 224 æ ¼)
[Server thread/INFO] RoadWeaver: åˆ›å»ºé“è·¯è¿æ¥ (300, 64, 400) <-> (500, 64, 600) (è·ç¦»: 283 æ ¼)
[Server thread/INFO] RoadWeaver: åˆ›å»ºé“è·¯è¿æ¥ (500, 64, 600) <-> (700, 64, 800) (è·ç¦»: 283 æ ¼)
...
[Server thread/INFO] RoadWeaver: å·²åˆ›å»º 9 æ¡æ–°é“è·¯è¿æ¥ï¼Œæ€»è®¡ 9 æ¡è¿æ¥ï¼Œé˜Ÿåˆ—å¤§å°: 9
```

## ğŸ“ˆ æ€§èƒ½åˆ†æ

### æ—¶é—´å¤æ‚åº¦

| æ­¥éª¤ | å¤æ‚åº¦ | è¯´æ˜ |
|------|--------|------|
| **ç”Ÿæˆæ‰€æœ‰è¾¹** | O(nÂ²) | n ä¸ªç»“æ„ï¼Œç”Ÿæˆ n(n-1)/2 æ¡è¾¹ |
| **æ’åº** | O(nÂ² log n) | å¯¹ nÂ² æ¡è¾¹æ’åº |
| **Kruskal** | O(nÂ² Î±(n)) | Î±(n) æ˜¯åé˜¿å…‹æ›¼å‡½æ•°ï¼Œå‡ ä¹ä¸ºå¸¸æ•° |
| **æ€»è®¡** | O(nÂ² log n) | ä¸»è¦å¼€é”€åœ¨æ’åº |

### ç©ºé—´å¤æ‚åº¦

| æ•°æ®ç»“æ„ | ç©ºé—´ | è¯´æ˜ |
|----------|------|------|
| **è¾¹åˆ—è¡¨** | O(nÂ²) | å­˜å‚¨æ‰€æœ‰å¯èƒ½çš„è¾¹ |
| **å¹¶æŸ¥é›†** | O(n) | å­˜å‚¨çˆ¶èŠ‚ç‚¹æ˜ å°„ |
| **ç»“æœ** | O(n) | æœ€å¤š n-1 æ¡è¾¹ |
| **æ€»è®¡** | O(nÂ²) | ä¸»è¦å¼€é”€åœ¨è¾¹åˆ—è¡¨ |

### å®é™…æ€§èƒ½

| ç»“æ„æ•°é‡ | è¾¹æ•°é‡ | æ’åºæ—¶é—´ | Kruskal æ—¶é—´ | æ€»æ—¶é—´ |
|---------|--------|---------|-------------|--------|
| **10** | 45 | <1ms | <1ms | <1ms |
| **50** | 1,225 | ~5ms | ~2ms | ~7ms |
| **100** | 4,950 | ~20ms | ~5ms | ~25ms |
| **500** | 124,750 | ~500ms | ~50ms | ~550ms |

**ç»“è®º**ï¼šå¯¹äºå¤§å¤šæ•°åœºæ™¯ï¼ˆ< 100 ä¸ªç»“æ„ï¼‰ï¼Œæ€§èƒ½å®Œå…¨å¯æ¥å—ã€‚

## âœ… ä¼˜åŠ¿æ€»ç»“

### ä¸åŸç®—æ³•å¯¹æ¯”

| æŒ‡æ ‡ | åŸç®—æ³•ï¼ˆæœ€è¿‘é‚»ï¼‰ | MST ç®—æ³•ï¼ˆKruskalï¼‰ |
|------|----------------|-------------------|
| **è¿é€šæ€§** | âŒ ä¸ä¿è¯ | âœ… ä¿è¯æ‰€æœ‰ç»“æ„è¿é€š |
| **è·¯å¾„é•¿åº¦** | âŒ ä¸æ˜¯æœ€ä¼˜ | âœ… æ€»é•¿åº¦æœ€çŸ­ |
| **è¿æ¥æ•°é‡** | âŒ ä¸ç¡®å®š | âœ… æ°å¥½ n-1 æ¡ |
| **ä¾èµ–é¡ºåº** | âŒ ä¾èµ–å‘ç°é¡ºåº | âœ… ä¸ä¾èµ–é¡ºåº |
| **ç¯è·¯** | âŒ å¯èƒ½æœ‰ç¯è·¯ | âœ… æ— ç¯è·¯ |
| **æ—¶é—´å¤æ‚åº¦** | O(n) | O(nÂ² log n) |

### å®é™…æ¸¸æˆä½“éªŒ

1. **âœ… æ‰€æœ‰ç»“æ„éƒ½èƒ½åˆ°è¾¾**
   - ä¸ä¼šæœ‰å­¤ç«‹çš„æ‘åº„
   - é“è·¯ç½‘ç»œå®Œæ•´

2. **âœ… è·¯å¾„æ›´åˆç†**
   - æ€»è·¯å¾„é•¿åº¦æœ€çŸ­
   - ä¸ä¼šç»•è¿œè·¯

3. **âœ… è§†è§‰æ•ˆæœæ›´å¥½**
   - é“è·¯åˆ†å¸ƒå‡åŒ€
   - æ²¡æœ‰é‡å¤è·¯å¾„

4. **âœ… æ€§èƒ½å¯æ¥å—**
   - å³ä½¿ 100 ä¸ªç»“æ„ä¹Ÿåªéœ€ ~25ms
   - ä¸å½±å“æ¸¸æˆä½“éªŒ

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### è·¯å¾„å‹ç¼©ä¼˜åŒ–

å¹¶æŸ¥é›†ä½¿ç”¨è·¯å¾„å‹ç¼©ï¼Œå°†æŸ¥æ‰¾æ—¶é—´ä» O(log n) ä¼˜åŒ–åˆ° O(Î±(n))ï¼š

```java
BlockPos find(BlockPos node) {
    if (!parent.get(node).equals(node)) {
        parent.put(node, find(parent.get(node)));  // é€’å½’å‹ç¼©è·¯å¾„
    }
    return parent.get(node);
}
```

### å»é‡æœºåˆ¶

é¿å…é‡å¤åˆ›å»ºå·²å­˜åœ¨çš„è¿æ¥ï¼š

```java
if (!connectionExists(existingConnections, connection.from(), connection.to())) {
    existingConnections.add(connection);
    queue.add(connection);
}
```

### åŒå‘è¿æ¥

è¿æ¥æ˜¯åŒå‘çš„ï¼ŒA-B å’Œ B-A è¢«è§†ä¸ºåŒä¸€æ¡è¿æ¥ï¼š

```java
boolean connectionExists(List<Connection> connections, BlockPos a, BlockPos b) {
    for (Connection c : connections) {
        if ((c.from == a && c.to == b) || (c.from == b && c.to == a)) {
            return true;
        }
    }
    return false;
}
```

## ğŸ“š å‚è€ƒèµ„æ–™

- **Kruskal ç®—æ³•**ï¼šhttps://en.wikipedia.org/wiki/Kruskal%27s_algorithm
- **å¹¶æŸ¥é›†**ï¼šhttps://en.wikipedia.org/wiki/Disjoint-set_data_structure
- **æœ€å°ç”Ÿæˆæ ‘**ï¼šhttps://en.wikipedia.org/wiki/Minimum_spanning_tree

---

**å®ç°æ—¥æœŸ**: 2025-01-15  
**ç®—æ³•**: Kruskal's Minimum Spanning Tree  
**æ—¶é—´å¤æ‚åº¦**: O(nÂ² log n)  
**ç©ºé—´å¤æ‚åº¦**: O(nÂ²)  
**çŠ¶æ€**: âœ… å·²å®ç°å¹¶æµ‹è¯•
